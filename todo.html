<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Landmark Church Tasks</title>
	<style>
		/* General Styles */
		body {
			font-family: Arial, sans-serif;
			background-color: #f5f5f5;
			max-width: 700px;
			margin: auto;
			padding: 20px;
			line-height: 1.6;
			color: #333;
		}

		h1, h2 {
			text-align: center;
			margin-bottom: 10px;
		}

		h2 {
			border-bottom: 2px solid #ddd;
			padding-bottom: 5px;
		}

		/* Blurb Section */
		.blurb {
			font-size: 16px;
			margin-bottom: 20px;
			padding: 15px;
			background: white;
			border-radius: 5px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.email-button {
			display: inline-block;
			margin-top: 10px;
			padding: 10px 15px;
			background-color: #007BFF;
			color: white;
			text-decoration: none;
			font-size: 14px;
			border-radius: 5px;
			transition: background 0.3s;
		}

		.email-button:hover {
			background-color: #0056b3;
		}

		/* Task Cards */
		.task {
			background: white;
			padding: 15px;
			margin: 10px 0;
			border-radius: 5px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.task-name {
			font-size: 20px;
			font-weight: bold;
			margin-bottom: 5px;
		}

		.task-desc {
			font-size: 15px;
			color: #555;
			margin-bottom: 10px;
		}

		.task-due {
			font-size: 13px;
			color: #888;
			margin-top: 10px;
			display: block;
		}

		/* Completed Tasks */
		.completed-list {
			list-style-type: none;
			padding: 0;
		}

		.completed-list li {
			text-decoration: line-through;
			color: #777;
			font-size: 16px;
			padding: 5px 0;
		}
	</style>
</head>
<body>
	<h1>Landmark Church Tasks</h1>

	<div class="blurb">
		<p>We truly appreciate your willingness to help keep Landmark Church running smoothly. Your time and effort make a difference! The following is a list of tasks where we could use your help in the upcoming days. If youâ€™d like to take on a task, please get in touch so we can work through the details with you.</p>
		<a href="mailto:matt@landmarklafayette.com" class="email-button">Contact Pastor Matt</a>
	</div>

	<h2>Incomplete Tasks</h2>
	<div id="pending"></div>

	<h2>Completed Tasks</h2>
	<ul id="completed" class="completed-list"></ul>

	<script>
		fetch("https://landmarklafayette.com/.netlify/functions/getTasks")
			.then(response => response.json())
			.then(tasks => {
				// Sort tasks by date added (most recent first)
				tasks.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));

				const pendingDiv = document.getElementById("pending");
				const completedList = document.getElementById("completed");

				tasks.forEach(task => {
					if (task.completed) {
						// Add to completed list (only task name, strikethrough)
						const completedItem = document.createElement("li");
						completedItem.textContent = task.content;
						completedList.appendChild(completedItem);
					} else {
						// Create a task card for pending tasks
						const taskElement = document.createElement("div");
						taskElement.classList.add("task");

						let taskContent = `<div class="task-name">${task.content}</div>`;

						if (task.description) {
							taskContent += `<div class="task-desc">${task.description}</div>`;
						}

						if (task.due) {
							taskContent += `<span class="task-due">Due: ${task.due.string}</span>`;
						}

						taskElement.innerHTML = taskContent;
						pendingDiv.appendChild(taskElement);
					}
				});
			})
			.catch(error => {
				console.error("Error fetching tasks:", error);
				document.body.innerHTML = "<p>Failed to load tasks.</p>";
			});
	</script>
</body>
</html>
